[gd_scene load_steps=5 format=3 uid="uid://t3vnm1lbpphd"]

[ext_resource type="PackedScene" uid="uid://cwqowh0kgiels" path="res://Scenes/UI/combat_player_ui.tscn" id="1_7uj85"]
[ext_resource type="PackedScene" uid="uid://cf11t36eqnirk" path="res://Scenes/player_character.tscn" id="2_2ip8y"]
[ext_resource type="PackedScene" uid="uid://crmeup0pjy7wf" path="res://Scenes/enemy_character.tscn" id="3_vtehv"]
[ext_resource type="PackedScene" uid="uid://dxvjktdaf834m" path="res://Scenes/combat_manager.tscn" id="4_loea4"]

[node name="CombatScene" type="Node2D"]

[node name="CombatManager" parent="." node_paths=PackedStringArray("combat_ui", "player", "enemy") instance=ExtResource("4_loea4")]
combat_ui = NodePath("../CombatPlayerUI")
player = NodePath("../PlayerCharacter")
enemy = NodePath("../EnemyCharacter")

[node name="PlayerCharacter" parent="." instance=ExtResource("2_2ip8y")]
position = Vector2(200, 500)
scale = Vector2(6, 6)

[node name="EnemyCharacter" parent="." instance=ExtResource("3_vtehv")]
position = Vector2(900, 200)
scale = Vector2(6, 6)

[node name="CombatPlayerUI" parent="." instance=ExtResource("1_7uj85")]

[connection signal="battle_log_choser_added" from="CombatManager" to="CombatPlayerUI" method="update_log"]
[connection signal="battle_log_critical_added" from="CombatManager" to="CombatPlayerUI" method="update_log"]
[connection signal="battle_log_damage_added" from="CombatManager" to="CombatPlayerUI" method="update_log"]
[connection signal="battle_log_heal_added" from="CombatManager" to="CombatPlayerUI" method="update_log"]
[connection signal="battle_log_miss_added" from="CombatManager" to="CombatPlayerUI" method="update_log"]
[connection signal="execute_enemy_turn" from="CombatManager" to="PlayerCharacter" method="update_hp"]
[connection signal="execute_enemy_turn" from="CombatManager" to="EnemyCharacter" method="update_hp"]
[connection signal="execute_player_turn" from="CombatManager" to="PlayerCharacter" method="update_hp"]
[connection signal="execute_player_turn" from="CombatManager" to="EnemyCharacter" method="update_hp"]
[connection signal="execute_player_turn" from="CombatManager" to="CombatPlayerUI" method="player_turn_start"]
[connection signal="player_death" from="CombatManager" to="CombatPlayerUI" method="player_pokemon_death"]
[connection signal="active_player_pokemon" from="PlayerCharacter" to="CombatPlayerUI" method="update_active_pokemon"]
[connection signal="all_player_pokemon" from="PlayerCharacter" to="CombatPlayerUI" method="initialise_pokemon_instances"]
[connection signal="item_to_use" from="CombatPlayerUI" to="CombatManager" method="use_item"]
